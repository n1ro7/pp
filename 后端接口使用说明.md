# 后端接口使用说明文档

## 项目概述

本文档详细描述了后端系统提供的所有API接口，包括认证、用户管理、资产管理、消息通知、报告管理和仪表盘等功能模块的接口使用方法。

## 基础信息

- 接口基础URL：`http://localhost:8080/api`
- 响应格式：统一JSON格式，包含code、message和data字段
- 成功响应示例：
  ```json
  {
    "code": 200,
    "message": "操作成功",
    "data": {}
  }
  ```

## 1. 认证相关接口（AuthController）

### 1.1 登录接口

- **URL**: `/auth/login`
- **方法**: `POST`
- **描述**: 用户登录认证
- **请求体**:
  ```json
  {
    "username": "string",
    "password": "string"
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "登录成功",
    "data": {
      "token": "string",
      "user": {}
    }
  }
  ```

### 1.2 获取当前用户信息

- **URL**: `/auth/current-user`
- **方法**: `GET`
- **描述**: 获取当前登录用户信息
- **请求参数**:
  - `username`: string, 用户名
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "id": 1,
      "username": "string",
      "name": "管理员",
      "role": "admin"
    }
  }
  ```

### 1.3 注销接口

- **URL**: `/auth/logout`
- **方法**: `POST`
- **描述**: 用户注销
- **请求体**: 无
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "注销成功"
  }
  ```

## 2. 管理员相关接口（AdminController）

### 2.1 获取用户列表

- **URL**: `/admin/users`
- **方法**: `GET`
- **描述**: 分页获取用户列表，支持搜索筛选
- **请求参数**:
  - `page`: int, 页码，默认1
  - `pageSize`: int, 每页条数，默认10
  - `search`: string, 搜索关键词（可选）
  - `role`: string, 用户角色（可选）
  - `status`: string, 用户状态（可选）
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "list": [],
      "total": 100,
      "page": 1,
      "pageSize": 10
    }
  }
  ```

### 2.2 添加用户

- **URL**: `/admin/users`
- **方法**: `POST`
- **描述**: 添加新用户
- **请求体**:
  ```json
  {
    "username": "string",
    "password": "string",
    "name": "string",
    "role": "string",
    "status": "string"
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "添加成功",
    "data": {}
  }
  ```

### 2.3 更新用户

- **URL**: `/admin/users/{userId}`
- **方法**: `PUT`
- **描述**: 更新用户信息
- **请求参数**:
  - `userId`: long, 用户ID
- **请求体**:
  ```json
  {
    "name": "string",
    "role": "string",
    "status": "string"
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "更新成功",
    "data": {}
  }
  ```

### 2.4 删除用户

- **URL**: `/admin/users/{userId}`
- **方法**: `DELETE`
- **描述**: 删除用户
- **请求参数**:
  - `userId`: long, 用户ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "删除成功"
  }
  ```

### 2.5 重置密码

- **URL**: `/admin/users/{userId}/reset-password`
- **方法**: `POST`
- **描述**: 重置用户密码
- **请求参数**:
  - `userId`: long, 用户ID
- **请求体**:
  ```json
  {
    "newPassword": "string"
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "密码重置成功",
    "data": {}
  }
  ```

### 2.6 获取操作日志

- **URL**: `/admin/operation-logs`
- **方法**: `GET`
- **描述**: 获取系统操作日志
- **请求参数**:
  - `page`: int, 页码，默认1
  - `pageSize`: int, 每页条数，默认20
  - `operator`: string, 操作人（可选）
  - `operationType`: string, 操作类型（可选）
  - `startDate`: string, 开始日期（可选）
  - `endDate`: string, 结束日期（可选）
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "list": [],
      "total": 1000
    }
  }
  ```

### 2.7 获取系统设置

- **URL**: `/admin/system-settings`
- **方法**: `GET`
- **描述**: 获取系统设置
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {}
  }
  ```

### 2.8 更新系统设置

- **URL**: `/admin/system-settings`
- **方法**: `PUT`
- **描述**: 更新系统设置
- **请求体**:
  ```json
  {
    "key": "value",
    ...
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "更新成功"
  }
  ```

## 3. 资产管理接口（AssetController）

### 3.1 获取资产列表

- **URL**: `/assets`
- **方法**: `GET`
- **描述**: 获取用户资产列表，支持按类型筛选
- **请求参数**:
  - `userId`: long, 用户ID
  - `type`: string, 资产类型（可选）
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": [
      {
        "id": 1,
        "userId": 1,
        "type": "stock",
        "name": "资产名称",
        "value": 10000.00,
        "acquisitionDate": "2024-01-01"
      }
    ]
  }
  ```

### 3.2 获取资产详情

- **URL**: `/assets/{assetId}`
- **方法**: `GET`
- **描述**: 获取资产详细信息
- **请求参数**:
  - `assetId`: long, 资产ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "id": 1,
      "userId": 1,
      "type": "stock",
      "name": "资产名称",
      "value": 10000.00,
      "acquisitionDate": "2024-01-01",
      "description": "资产描述"
    }
  }
  ```

### 3.3 添加资产

- **URL**: `/assets`
- **方法**: `POST`
- **描述**: 添加新资产
- **请求体**:
  ```json
  {
    "userId": 1,
    "type": "stock",
    "name": "资产名称",
    "value": 10000.00,
    "acquisitionDate": "2024-01-01",
    "description": "资产描述"
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "添加成功",
    "data": {
      "id": 1,
      ...
    }
  }
  ```

### 3.4 更新资产

- **URL**: `/assets/{assetId}`
- **方法**: `PUT`
- **描述**: 更新资产信息
- **请求参数**:
  - `assetId`: long, 资产ID
- **请求体**:
  ```json
  {
    "name": "新资产名称",
    "value": 15000.00,
    "description": "更新后的描述"
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "更新成功",
    "data": {
      ...
    }
  }
  ```

### 3.5 删除资产

- **URL**: `/assets/{assetId}`
- **方法**: `DELETE`
- **描述**: 删除资产
- **请求参数**:
  - `assetId`: long, 资产ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "删除成功"
  }
  ```

### 3.6 获取资产统计数据

- **URL**: `/assets/stats/{userId}`
- **方法**: `GET`
- **描述**: 获取用户资产统计数据
- **请求参数**:
  - `userId`: long, 用户ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "totalValue": 100000.00,
      "assetTypeCount": 5,
      "monthlyChange": 5.2
    }
  }
  ```

## 4. 消息通知接口（MessageController）

### 4.1 获取消息列表

- **URL**: `/messages`
- **方法**: `GET`
- **描述**: 获取用户消息列表，支持分页和筛选
- **请求参数**:
  - `userId`: long, 用户ID
  - `page`: int, 页码，默认1
  - `pageSize`: int, 每页条数，默认10
  - `cryptoType`: string, 加密货币类型（可选）
  - `marketImpact`: string, 市场影响（可选）
  - `isRead`: string, 是否已读（可选）
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "list": [],
      "total": 50
    }
  }
  ```

### 4.2 获取消息详情

- **URL**: `/messages/{messageId}`
- **方法**: `GET`
- **描述**: 获取消息详细内容
- **请求参数**:
  - `messageId`: long, 消息ID
  - `userId`: long, 用户ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "id": 1,
      "title": "消息标题",
      "content": "消息内容",
      "isRead": false,
      "sendTime": "2024-01-01 10:00:00"
    }
  }
  ```

### 4.3 标记消息为已读

- **URL**: `/messages/{messageId}/read`
- **方法**: `PUT`
- **描述**: 标记单条消息为已读状态
- **请求参数**:
  - `messageId`: long, 消息ID
  - `userId`: long, 用户ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "标记成功"
  }
  ```

### 4.4 批量标记消息为已读

- **URL**: `/messages/batch-read`
- **方法**: `PUT`
- **描述**: 批量标记多条消息为已读状态
- **请求体**:
  ```json
  {
    "userId": 1,
    "messageIds": [1, 2, 3, 4, 5]
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "批量标记成功"
  }
  ```

### 4.5 获取未读消息数

- **URL**: `/messages/unread-count`
- **方法**: `GET`
- **描述**: 获取用户未读消息数量
- **请求参数**:
  - `userId`: long, 用户ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": 5
  }
  ```

### 4.6 删除消息

- **URL**: `/messages/{messageId}`
- **方法**: `DELETE`
- **描述**: 删除消息
- **请求参数**:
  - `messageId`: long, 消息ID
  - `userId`: long, 用户ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "删除成功"
  }
  ```

## 5. 报告管理接口（ReportController）

### 5.1 获取报告列表

- **URL**: `/reports`
- **方法**: `GET`
- **描述**: 获取报告列表，支持分页和筛选
- **请求参数**:
  - `page`: int, 页码，默认1
  - `pageSize`: int, 每页条数，默认10
  - `status`: string, 报告状态（可选）
  - `cryptoType`: string, 加密货币类型（可选）
  - `analyst`: string, 分析师（可选）
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "list": [],
      "total": 30
    }
  }
  ```

### 5.2 获取报告详情

- **URL**: `/reports/{reportId}`
- **方法**: `GET`
- **描述**: 获取报告详细内容
- **请求参数**:
  - `reportId`: long, 报告ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "id": 1,
      "title": "报告标题",
      "content": "报告内容",
      "cryptoType": "BTC",
      "status": "approved",
      "analyst": "分析师名称",
      "createTime": "2024-01-01"
    }
  }
  ```

### 5.3 添加报告

- **URL**: `/reports`
- **方法**: `POST`
- **描述**: 添加新报告
- **请求体**:
  ```json
  {
    "title": "报告标题",
    "content": "报告内容",
    "cryptoType": "BTC",
    "analyst": "分析师名称"
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "添加成功",
    "data": {
      "id": 1,
      ...
    }
  }
  ```

### 5.4 更新报告

- **URL**: `/reports/{reportId}`
- **方法**: `PUT`
- **描述**: 更新报告信息
- **请求参数**:
  - `reportId`: long, 报告ID
- **请求体**:
  ```json
  {
    "title": "新报告标题",
    "content": "更新后的内容",
    "cryptoType": "ETH"
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "更新成功",
    "data": {
      ...
    }
  }
  ```

### 5.5 删除报告

- **URL**: `/reports/{reportId}`
- **方法**: `DELETE`
- **描述**: 删除报告
- **请求参数**:
  - `reportId`: long, 报告ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "删除成功"
  }
  ```

### 5.6 审核报告

- **URL**: `/reports/{reportId}/review`
- **方法**: `PUT`
- **描述**: 审核报告，设置审核状态
- **请求参数**:
  - `reportId`: long, 报告ID
- **请求体**:
  ```json
  {
    "status": "approved",
    "reviewerNote": "审核意见",
    "reviewerId": 1
  }
  ```
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "审核成功",
    "data": {
      ...
    }
  }
  ```

### 5.7 获取待处理报告数量

- **URL**: `/reports/pending/count`
- **方法**: `GET`
- **描述**: 获取待审核报告的数量
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": 3
  }
  ```

### 5.8 获取报告统计数据

- **URL**: `/reports/stats`
- **方法**: `GET`
- **描述**: 获取报告统计信息
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "totalReports": 30,
      "approvedReports": 25,
      "pendingReports": 3,
      "rejectedReports": 2
    }
  }
  ```

## 6. 仪表盘接口（DashboardController）

### 6.1 获取仪表盘统计数据

- **URL**: `/dashboard/stats`
- **方法**: `GET`
- **描述**: 获取用户仪表盘统计数据
- **请求参数**:
  - `userId`: long, 用户ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "totalAssets": 100000.00,
      "todayChange": 1500.00,
      "totalMessages": 5,
      "unreadMessages": 2
    }
  }
  ```

### 6.2 获取资产分布数据

- **URL**: `/dashboard/asset-distribution`
- **方法**: `GET`
- **描述**: 获取用户资产分布情况
- **请求参数**:
  - `userId`: long, 用户ID
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "stock": 40.5,
      "bond": 25.2,
      "fund": 15.3,
      "realEstate": 12.0,
      "cash": 7.0
    }
  }
  ```

### 6.3 获取最近交易记录

- **URL**: `/dashboard/recent-transactions`
- **方法**: `GET`
- **描述**: 获取用户最近交易记录
- **请求参数**:
  - `userId`: long, 用户ID
  - `limit`: int, 返回条数限制，默认10
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取成功",
    "data": {
      "transactions": [
        {
          "id": 1,
          "type": "buy",
          "assetName": "BTC",
          "amount": 0.5,
          "price": 40000.00,
          "time": "2024-01-01 10:00:00"
        }
      ]
    }
  }
  ```

## 7. 通用响应码说明

| 响应码 | 说明 |
|--------|------|
| 200    | 操作成功 |
| 400    | 请求参数错误 |
| 401    | 未授权 |
| 403    | 禁止访问 |
| 404    | 资源不存在 |
| 500    | 服务器内部错误 |

## 8. 使用建议

1. 所有接口调用前请确保已完成登录认证
2. 分页查询时建议合理设置pageSize参数，避免一次性获取过多数据
3. 敏感操作（如删除、更新）建议在前端进行二次确认
4. 对于大量数据的接口调用，建议实现请求超时和重试机制
5. 实时数据建议使用WebSocket或轮询机制更新

---

本文档由后端开发团队维护，最后更新时间：2024年1月1日